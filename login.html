<!DOCTYPE html>
<html>
<head>
  <?!= include('css'); ?>
</head>
<body>

<div class="box">
  <h3>Login</h3>

  <input id="username" placeholder="Username">
  <input id="password" type="password" placeholder="Password">

  <button onclick="login()">Login</button>
  <p id="msg" style="color:red;"></p>

  <div class="link">
    <a href="#" onclick="loadSignup()">Create Account</a>
  </div>
</div>

<script>
function loadSignup() {
  google.script.run.withSuccessHandler(function(page) {
    document.open(); document.write(page); document.close();
  }).include('signup');
}

function login() {
  let user = username.value;
  let pass = password.value;

  google.script.run.withSuccessHandler(function(result) {

    if (result.success) {
      google.script.run
        .withSuccessHandler(function(page) {
          document.open(); document.write(page); document.close();
        })
        .include('home?name=' + encodeURIComponent(result.fullname));
    } else {
      msg.innerText = "Invalid Login";
    }

  }).checkLogin(user, pass);
}
</script>

</body>
</html>
